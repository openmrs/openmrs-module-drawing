<div>
	<div id="textarea-popup" data-mode="create">
	    <textarea id="annotation-text" wrap="off"></textarea>
	    <div>
	        <button id="annotation-save" type="button" onclick="createText();"><i class="material-icons">save</i></button>
	        <button id="annotation-cancel" type="button" onclick="resetTextarea();"><i class="material-icons">cancel</i></button>
	    </div>
	</div>
	
	<div id="template-image-popup" style="position: absolute; display: none;" data-mode="create">
	    <div id="template-image-list">
	
	    </div>
	    <div id="template-image-preview">
<!--	        <img id="template-image" src=""></img>-->
	    </div>
	</div>
	
	<!-- cursor icon -->
	<svg style="display:none;" viewbox="0 0 .1 .1"><g><path stroke="black" stroke-width="3" id="cursor-svg" d="M52.982,63.626L32.084,42.729L19.151,62.087L0.374,0.374l61.704,18.775L42.775,32.132l20.852,20.849L52.982,63.626z    M31.791,39.761L52.982,60.95l7.969-7.969L39.813,31.845L57.719,19.8L3.217,3.218l16.58,54.494L31.791,39.761z"/></g></svg>

	<div id="toolbar">
		<button id="select-tool" width="24px" height="24px" type="button" onclick="setSelectTool(event);">
			<svg width="24px" height="24px" viewbox="0 0 65 65"><use href="#cursor-svg"/></svg>
		</button>
		<button id="text-tool"  type="button" onclick="setTextTool(event);"><i class="material-icons">format_shapes</i></button>
		<button id="template-button" type="button" onclick="selectTemplate(event);"><i class="material-icons">image</i></button>
		<button id="load-image-button" type="button" onclick="document.getElementById('load-image-file-input').click();"><i class="material-icons">file_upload</i><i class="material-icons">image</i></button>
		<button id="path-tool" type="button" onclick="setPathTool();"><i class="material-icons">gesture</i></button>
		<button id="line-tool"  type="button" onclick="setLineTool();"><i class="material-icons">border_color</i></button>
		<button id="circle-tool" type="button" onclick="setCircleTool();"><i class="material-icons">panorama_fish_eye</i></button>
		<button id="save-image" type="button" onclick="submitSave();"><i class="material-icons">save</i></button>
		<button id="clear-all" type="button" onclick="clearAll();"><i class="material-icons">delete_sweep</i></button>
		<button id="layer-info-vis-toggle" type="button" onclick="toggleLayerInfoVis();"><i class="material-icons">layers</i></button>
	</div>
	
	<input id="load-image-file-input" type="file" class="hidden"><!--comment preserves xml compatibility--></input>
	
	<div id="view-layer-parent">
	  <div id="layer-button-div">
	        <button id="edit-tool" type="button" class="vert-button layer-button disabled" onclick="setEditTool();"><i class="material-icons">edit</i></button>
	        <button id="move-tool" type="button" class="vert-button layer-button disabled" onclick="setMoveTool();"><i class="material-icons">open_with</i></button>
	        <button id="send-to-front-tool" type="button" class="vert-button layer-button disabled" onclick="setSendFrontTool();"><i class="material-icons">flip_to_front</i></button>
	        <button id="move-forward-tool" type="button" class="vert-button layer-button disabled" onclick="setForwardTool();"><i class="material-icons">arrow_upward</i></button>
	        <button id="move-backward-tool" type="button" class="vert-button layer-button disabled" onclick="setBackwardTool();"><i class="material-icons">arrow_downward</i></button>
	        <button id="send-to-back-tool" type="button" class="vert-button layer-button disabled" onclick="setSendBackTool();"><i class="material-icons">flip_to_back</i></button>
	        <button id="void-tool" type="button" class="vert-button layer-button disabled" onclick="setVoidTool();"><i class="material-icons">delete</i></button>
	        <button id="delete-tool" type="button" class="vert-button layer-button disabled" onclick="setDeleteTool();"><i class="material-icons">delete_forever</i></button>
	  </div>	
	  <div id="svg-container-div" class="view-div">
	    <svg id="root-svg" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink">
		  
			<rect id="background" width="100%" height="100%" fill="white"><!-- background rect -->></rect>
			<filter id="dropshadow" height="130%">
	          <feGaussianBlur in="SourceAlpha" stdDeviation="3"/> <!-- stdDeviation is how much to blur -->
	        <!-- <feComponentTransfer>
	        <feFuncR type="linear" slope=".01" intercept="1"/>
	        <feFuncG type="linear" slope="0" intercept="0"/>
	        <feFuncB type="linear" slope="0" intercept="0"/>
	        <feFuncA type="linear" slope="0" intercept="1"/>
	        </feComponentTransfer>  -->
	        
	          <feComponentTransfer>
	            <feFuncA type="linear" slope="0.8"/> <!-- slope is the opacity of the shadow -->
	          </feComponentTransfer>
	          <feMerge> 
	            <feMergeNode/> <!-- this contains the offset blurred image -->
	            <feMergeNode in="SourceGraphic"/> <!-- this contains the element that the filter is applied to -->
	          </feMerge>
			</filter>
			<!-- Google Maps like location icon SVG, CCA 3 by Mono : https://commons.wikimedia.org/wiki/File:Map_pin_icon.svg 
			modifications include id -->
			<defs>
				<svg
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:cc="http://creativecommons.org/ns#"
				xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:svg="http://www.w3.org/2000/svg"
				xmlns="http://www.w3.org/2000/svg"
				xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
				xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
				id="pin-icon"
				version="1.1"
				inkscape:version="0.47 r22583"
				width="94"
				height="128"
				sodipodi:docname="pin.svg" >
				<metadata
					id="metadata2822">
					<rdf:RDF>
					<cc:Work
						rdf:about="">
						<dc:format>image/svg+xml</dc:format>
						<dc:type
							rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
					</cc:Work>
					</rdf:RDF>
				</metadata>
				<defs
					id="defs2820">
					<inkscape:perspective
						sodipodi:type="inkscape:persp3d"
						inkscape:vp_x="0 : 0.5 : 1"
						inkscape:vp_y="0 : 1000 : 0"
						inkscape:vp_z="1 : 0.5 : 1"
						inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
						id="perspective2824" />
				</defs>
				<sodipodi:namedview
					pagecolor="#ffffff"
					bordercolor="#666666"
					borderopacity="1"
					objecttolerance="10"
					gridtolerance="10"
					guidetolerance="10"
					inkscape:pageopacity="0"
					inkscape:pageshadow="2"
					inkscape:window-width="1126"
					inkscape:window-height="809"
					id="namedview2818"
					showgrid="false"
					inkscape:zoom="3.0991164"
					inkscape:cx="44.920355"
					inkscape:cy="60.493358"
					inkscape:window-x="287"
					inkscape:window-y="0"
					inkscape:window-maximized="0"
					inkscape:current-layer="svg2816" />
				<path
					style="fill:#c64242;fill-opacity:0.98823529"
					d="M 46.977003,126.64334 C 46.693972,125.95584 40.813862,120.20567 36.603071,114.98067 11.655836,81.858372 -16.158365,51.082905 16.319943,13.682837 30.700637,-0.21083367 48.43303,-1.0034227 66.662563,5.4726973 117.9922,35.174601 80.828906,83.627914 56.427079,115.48067 l -9.450076,11.16267 z M 62.417383,75.872046 C 96.654166,51.387445 70.185413,4.2391813 32.569429,19.913013 21.585178,25.769872 16.134954,35.960547 15.944071,47.980664 c -0.524495,11.693153 5.685418,21.471037 15.526227,27.460808 7.055481,3.840074 10.157178,4.533661 18.145697,4.057654 5.177622,-0.308516 8.161127,-1.153847 12.801388,-3.62708 z"
					id="path4127"
					sodipodi:nodetypes="ccccccccccsc" />
				<path
					sodipodi:type="arc"
					style="fill:#c64242;fill-opacity:0.98823529;fill-rule:nonzero;stroke:none"
					id="path4129"
					sodipodi:cx="52.363636"
					sodipodi:cy="49.05526"
					sodipodi:rx="51.222816"
					sodipodi:ry="41.754009"
					d="m 41.682107,89.891342 a 51.222816,41.754009 0 1 1 1.276617,0.208091"
					sodipodi:start="1.7808687"
					sodipodi:end="8.0386371"
					sodipodi:open="true"
					transform="matrix(0.87829487,0,0,1.0519028,0.55474126,-6.9952658)" />
				<path
					sodipodi:type="arc"
					style="opacity:0.34016395;fill:#000000;fill-opacity:0;fill-rule:nonzero;stroke:none"
					id="path4131"
					sodipodi:cx="49.05526"
					sodipodi:cy="48.59893"
					sodipodi:rx="26.010695"
					sodipodi:ry="20.991087"
					d="m 43.631232,69.128546 a 26.010695,20.991087 0 1 1 0.64826,0.104614"
					sodipodi:start="1.7808687"
					sodipodi:end="8.0386371"
					sodipodi:open="true"
					transform="translate(0.64534523,0)" />
				<path
					sodipodi:type="arc"
					style="fill:#000080;fill-opacity:0;fill-rule:nonzero;stroke:none"
					id="path4135"
					sodipodi:cx="35.365417"
					sodipodi:cy="102.78788"
					sodipodi:rx="16.655972"
					sodipodi:ry="11.750445"
					d="m 31.892136,114.28 a 16.655972,11.750445 0 1 1 0.415114,0.0586"
					sodipodi:start="1.7808687"
					sodipodi:end="8.0386371"
					sodipodi:open="true"
					transform="translate(0.64534523,0)" />
				<path
					sodipodi:type="arc"
					style="fill:#b72c2c;fill-opacity:1;fill-rule:nonzero;stroke:none"
					id="path4149"
					sodipodi:cx="52.705883"
					sodipodi:cy="52.021389"
					sodipodi:rx="34.452763"
					sodipodi:ry="33.540108"
					d="m 45.521425,84.824145 a 34.452763,33.540108 0 1 1 0.85866,0.167155"
					sodipodi:start="1.7808687"
					sodipodi:end="8.0386371"
					sodipodi:open="true"
					transform="matrix(0.97020484,0,0,1.0272058,-4.0587829,-5.7503824)" />
				<path
					sodipodi:type="arc"
					style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
					id="path4184"
					sodipodi:cx="64.211853"
					sodipodi:cy="68.789574"
					sodipodi:rx="34.203297"
					sodipodi:ry="36.623341"
					d="m 57.079416,104.60778 a 34.203297,36.623341 0 1 1 0.852443,0.18252"
					sodipodi:start="1.7808687"
					sodipodi:end="8.0386371"
					sodipodi:open="true"
					transform="matrix(0.64629924,0,0,0.61681122,5.1261236,4.9013803)" />
				</svg>
			</defs>

			<style>
				use:hover + g {
					visibility: visible;
				}
			</style>

			<script type="text/javascript">
				window.addEventListener("DOMContentLoaded", () => {
					
					console.log("svg script executed on dom content loaded");

					document.addEventListener("mousedown", (e) => {

						var clickedElement = document.elementFromPoint(e.clientX, e.clientY);

						console.log(clickedElement);
						
						if(clickedElement.nodeName==="use"){
							<!--written without & to avoid having to correctly escape back and forth for java w3c xml parser during server side loading-->
							while(clickedElement.nextSibling){
								if(clickedElement.nodeName !== "g") { 
									clickedElement = clickedElement.nextSibling;
								} else {
									break;
								}
							}
							if(clickedElement.getAttribute("visibility")=="collapse") {
								clickedElement.setAttribute("visibility", "visible");
							}else{
								clickedElement.setAttribute("visibility", "collapse");
							}
							e.preventDefault();
						}
					});
				});				
			
			</script>
<!--			
			<g transform="translate(100, 100)">
				<use class="marker" id="marker1" xlink:href="#pin-icon" transform="scale(.25)" x="100"/> 
				<text size="1em" visibility="collapse">Example Text 1</text>
			</g>
			<g transform="translate(100, 100)">
				<use id="marker2" xlink:href="#pin-icon" transform="scale(.25)" x="2"/> 
				<text size="1em" visibility="collapse">Example Text 2</text>
			</g>
-->
		</svg>
	  </div>
	  <div id="arrange" class="layer-div">
	    <div id="layer-list-div">
	      <table id="layer-list">
	        <thead>
	          <tr>
	            <th>Sel</th>
	            <th>Vis</th>
	            <th>Type</th>
	            <th>Content</th>
	          </tr>
	        </thead>
	        <tbody id="layer-list-rows">
	          <tr>
	            <td><input type="checkbox" class="disabled"><!--comment preserves xml compatibility--></input></td>
	            <td><button type="button" class="disabled"><i class="material-icons">visibility</i></button></td>
	            <td>Root</td>
	            <td><svg width="100%" height="100%" viewbox="0 0 10 10"><use href="#svg-root"/></svg></td>
	          </tr>
	        </tbody>
	      </table>
	    </div>
	  </div>
	</div>
</div>